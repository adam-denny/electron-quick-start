<!DOCTYPE html>
<html>
	<head>
		<title>Test</title>
	</head>
	<body>
		<style>
			video {
				border: 1px solid red;
			}
		</style>

		<video height="100" autoplay id="0"></video>
		<video height="100" autoplay id="1"></video>
		<video height="100" autoplay id="2"></video>
		<video height="100" autoplay id="3"></video>
		<video height="100" autoplay id="4"></video>

		<script>
			function setDevices(){
				let els = document.getElementsByTagName('video');
				for(let i = 0; i < els.length; ++i){
					let camera = els[i];
					let srcObject = camera.srcObject;
					if(srcObject) {
						if(srcObject){
							let audio = srcObject.getAudioTracks();
							let video = srcObject.getVideoTracks();
							if(audio[0]){
								srcObject.removeTrack(audio[0]);
							}
							if(video[0]){
								srcObject.removeTrack(video[0]);
							}
							srcObject = null;
							camera.srcObject = null;
						}
					}
				}
					
				setTimeout(() => {
					navigator.mediaDevices.enumerateDevices().then((devices, i) => {
						console.log(devices);

						let cams = devices.filter(device => device.kind === 'videoinput');

						cams.forEach((device, i) => {
							console.log(device.kind, device.label, device.deviceId);
							navigator.mediaDevices.getUserMedia({
								video: { id: {exact: device.deviceId} }
							}).then(stream => {
								let el = document.getElementById(String(i));
								el.srcObject = stream;
								el.onload = () => {
									el.play();
								}
							}).catch(e => console.error(e));
						});
					}).catch(e => console.error(e));
				}, 2000);
				
			}

			navigator.mediaDevices.ondevicechange = setDevices;

			setDevices();	
		</script>
	</body>
</html>
